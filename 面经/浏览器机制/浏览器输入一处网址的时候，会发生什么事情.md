# 浏览器输入一处网址的时候，会发生什么事情

### 1.请求部分

1. 首先判断请求的地址是不是一个域名，如果是域名，则进入步骤2
2. 地址是一个域名，需要向`DNS服务器`进行查询域名所对应的主机号，因为只有主机号才能找到互联网中的主机，首先确定采取的是运输层的`UDP`协议，即应用层发一个报文下去`UDP`发送请求
   - `DNS`查询的时候，会优先向本地域名服务器进行查询（可能不止一个），如果查询不到的话，会采用递归查询的方式向另外一个本地域名服务器进行请求。（递归即域名服务器会进行代理查询）。
   - 如果查询不到的话，会向权限域名服务器进行查询，权限域名服务器采取迭代查询的方式，即如果没有对应关系的话，会找到下一台权限域名服务器的地址返回给客户端，由客户端开启另外的`UDP`请求
3. 拿到`ip`地址后。先明确输入地址是一个`get`请求，以`http`为例吧，会将请求加上请求头，然后转为字节流传到运输层，然后发送`TCP`请求。
4. `TCP`首先要进行三次握手创建连接状态。建立连接后，将应用层下来的字节流根据大小封装成`TCP`数据包，然后进行传输，采用滑动窗口的形式进行传输数据。
5. 服务端的`TCP`接受到所有数据后，会将字节流按正确的顺序合并在一起，然后进行协议升级，确认是`http`协议，根据端口发送到对应的后台应用。

### 2.后台部分

1. 后台应用拿到请求头，根据`url`路径，在后台的`router`里面判断是对应哪个方法，如果是文件读取的话，会根据`url`读取对应的静态文件，以字节流的方式写回到`TCP`进行返回数据。

### 3.页面渲染部分

1. 浏览器拿到所有数据后，`TCP`进行四次挥手结束会话。
2. 解析HTML文件，将HTML转为DOM树，遇到css的话，阻塞去请求css文件。在加载完一个css的时候会跟`dom`树进行渲染，所以在加载的过程中会发生页面布局的重排和重绘。
3. 加载`script`标签，由同步加载、异步加载。其中异步加载还分为加载完毕后直接执行、等到文档加载完毕后再执行。
4. 文档加载完毕后，调用`DOMContentLoaded`事件
5. 所有资源文件加载完毕后，调用`window.onload`事件

### 