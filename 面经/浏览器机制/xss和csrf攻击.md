# XSS和CSRF攻击

### XSS

注入攻击，可以通过xml形式或者a标签的javascript进行注入攻击

#### 1、反射型XSS

发出请求时，XSS代码出现在URL中，作为输入提交到服务器端，服务器端解析后响应，XSS代码随响应内容一起传回给浏览器，最后浏览器解析执行XSS代码。这个过程像一次反射，故叫反射型XSS。

#### 2、存储型XSS

存储型XSS和反射型XSS的差别仅在于，提交的代码会存储在服务器端（数据库，内存，文件系统等），下次请求目标页面时不用再提交XSS代码

最典型的例子是留言板XSS，用户提交一条包含XSS代码的留言存储到数据库，目标用户查看留言板时，那些留言的内容会从数据库查询出来并显示，浏览器发现有XSS代码，就当做正常的HTML与Js解析执行，于是触发了XSS攻击。

#### 3、DOM型XSS

前端代码中存在着对数据渲染的时候使用了Dom.innerHTML、outerHTML或者在框架中使用了原生渲染，并且不去处理转义字符，

##### 如何解决xss注入问题：

存储型：会存储在数据库中，服务端可以进行标签的转为转义标签，或者前端使用框架来处理标签。

反射型：使用前后端分离即可，不使用服务端渲染。

DOM型：由于客户端脚本不对数据进行转义过滤，然后执行一些能够解析js代码或者渲染html代码的方法二导致的。

### CSRF（利用伪装是用户来进行攻击）

利用用户刚刚登陆的登陆状态来进行攻击，也就是如果是用`cookie`维持登陆状态的话，浏览器会携带`cookie`访问目标网站，这样就利用了登陆状态做很多事情。而解决问题的办法有如下：

1. 同源检测：http请求会携带请求的域源，我们通过同源检测来防止第三方的请求，但是如果是注入本域源下的攻击则没办法防止。
2. 双重cookie：上面提到，攻击者只能利用登陆状态干事情，不能拿到`cookie`那么就在请求url上面添加cookie进行验证
3. token：携带token进行校验，缺点是后台需要存储状态，会很麻烦。
4. samesite cookie：有strict和lax，前者是跨域（子域也不行）发送请求就不会带任何cookie信息，后者是跨域了只能在get请求里面携带，其他并不会携带。