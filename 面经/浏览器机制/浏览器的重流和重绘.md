# 浏览器的回流和重绘

### 什么是回流？为什么会导致回流？

- 回流是什么？

回流是浏览器在页面的某一处开始，对该处和以下的所有元素的大小和位置等进行重新计算然后显示的过程。

- 为什么会导致回流？
  - 浏览器是遵循流式布局结构，自上而下显示目标快
  - 浏览器的渲染过程是先生成`DOM`和`CSSOM`，然后两者合并生成`Render Tree`。再进行计算每一个标签所对应的位置和大小。
  - 如果已经渲染好了，但是对于在文档流中的某一个元素进行修改形状或者大小，那么浏览器要对文档流的该位置以及之后的位置的所有元素进行计算大小和位置。

### 什么是重绘，它跟回流的关系？

重绘只是更改元素的颜色、背景图等等，不会更改它在文档流的大小和位置，所以它不会触发浏览器进行重新计算位置。

回流和重绘的关系是：**回流一定重绘，重绘不一定回流**。

### 怎么产生回流？

当`Render Tree`上面的元素进行修改大小或者位置的时候，会对文档流进行修改，这样就会产生回流，浏览器就要重新计算部分或全部元素的大小和位置。这就是回流。

导致回流的方式：

- 修改文档流中的元素的大小或者位置
- 显示或者隐藏文档流中的某个元素。`display`
- 浏览器窗口发生改变。
- 对于全局字体大小进行修改，然后改变内联元素的大小。
- 进行添加或者删除元素等等。

### 如何避免过多的回流

1. 将动画效果脱离文档流：使用绝对布局来脱离文档流，这样动画效果在进行的时候，不会触发文档流的回流。
2. 将多个文档添加操作合并在一起，比如创建一个文档碎片，然后操作完毕后统一添加到文档流上面。
3. 尽量避免对元素的大小或者属性等进行操作。
4. 避免使用table布局。

