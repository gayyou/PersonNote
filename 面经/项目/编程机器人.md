# 可视化编程机器人问题

1. 根据代码嵌套结构设计存储数据结构，这个存储数据结构长什么样子？

   答：这个数据结构整体来看，是一棵树状结构。是以一个纯对象来进行实现，然后对象的键值是定义好的代码块名称，然后键值是一个数组，存放着这个容器具某种代码块的所有实例。而代码块的话，根据普通语句和判断循环语句，划分成两种：容器代码块和普通代码块。容器代码块也是具有子树结构，所以可以无限嵌套下去。

2. vue中为对象新增属性是不会触发相应数据的，你是怎么做到只关注数据就可以操纵代码块

   主要问题出现在容器内部，容器内部也是具有其他元素的引用的，然后传进来数据会被新建的容器所观察，所以能够实现深度嵌套也有数据响应。

3. 你是如何做到只关注数据即可对代码块进行操作的？

   首先要确定是svg矢量图，他是以html标签，也就是dom节点渲染到页面上的。所以代码块之间的嵌套关系可以用树状结构的嵌套关系来表示，所以我能用树状结构代表代码的嵌套关系。同时，我将这些html标签的一些属性都放到这棵数据树的节点内容中，然后我可以利用Vue的数据响应系统，对数据进行改变的时候会更新到视图层上面。

4. 如何实现数据压缩的？

   这个平台有个功能是存储用户所进行的提交，一开始我们是打算用另外一个接口直接把数据放进去就行了，但是发现这样不是很讲究。后来发现接口数据中代表代码块的执行顺序是依靠json的数组顺序来的，所以在转为json数组的时候，根据代码块的y坐标来定义决定它的执行顺序。而反过来也是这样进行的。

5. 为什么用svg，其他不行吗？

   svg是渲染在dom树上的，并且能够通过修改值来改变大小，比如说if语句中的高度会随着容纳元素的增加而增加，此时只能够通过svg才能够实现。

6. 了解过其他组件库吗？

   有一个blockly，是国内外很多编程平台使用到的插件，一开始我也在考虑是否使用它，但是后来觉得不妥：

   1.后面怎么根据代码获取json格式数据，显然要看源码，这个总体设计到到完成，只有15天时间，显然没有时间去研究源码。

   2.如果使用插件的话，成长空间很局限，觉得要挑战一下自己。

7. 拖拽模块是怎么实现的？

   利用鼠标的三个点击事件：mousedown，mousemove、mouseup。在mousedown的时候记住元素的位置、mousemove的时候使用dom操作修改元素的位置，这是整个项目中直接对dom进行操作的地方，在mousedown的时候修改数据。